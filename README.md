# Motoo Backend (모의투자 서비스)

## 서비스 개요

이 프로젝트는 한국투자증권 API에서 실시간/분단위 시세 데이터를 받아와, 사용자가 가상의 자산으로 주식 매수/매도, 포트폴리오 관리, 거래내역 확인 등을 할 수 있는 **모의투자(시뮬레이션) 서비스**입니다.

---

## 주요 도메인 및 로직

### 1. **User (사용자)**

- 회원가입/로그인(직접 구현 예정)
- 자산(시드머니, 현금), 가입일, 보유 주식, 체결 내역 등 관리

### 2. **Stock (주식)**

- 종목 코드, 이름, 시장, 산업, 현재가 등 정보 관리
- 한국투자증권 API에서 시세 데이터 수집 (PriceUtil)

### 3. **Order (주문)**

- 사용자가 매수/매도 주문을 생성 (PENDING 상태로 저장)
- 주문가, 수량, 주문유형(매수/매도), 상태(PENDING/COMPLETED/CANCELLED) 등

### 4. **Execution (체결)**

- 주문이 실제로 체결된 내역 (Execution)
- 체결가, 체결수량, 체결시각 등 기록

### 5. **UserStock (보유 주식)**

- 사용자가 현재 보유한 주식의 수량, 평단가 등 관리
- 체결 시 자동 업데이트

### 6. **Portfolio (포트폴리오)**

- 사용자의 전체 자산, 보유 주식별 수익률, 총 평가금액 등 조회

### 7. **거래내역 (Execution/Order)**

- 주문/체결 내역 조회 가능

### 8. **공통/유틸**

- PriceUtil: 실시간 시세 관리, 수익률 계산 등
- CommonResponse: API 응답 포맷 통일
- JPA Auditing: 생성일/수정일 자동 관리

---

## 현재 구현된 로직

- 주문 생성/조회/취소 (OrderService, OrderController)
- 체결 내역 조회 (ExecutionService, ExecutionController)
- 포트폴리오 조회 (PortfolioService, PortfolioController)
- 주식 목록/상세/검색 (StockService, StockController)
- 사용자 프로필 조회 (UserService, UserController)
- 실시간 시세 데이터 관리 (PriceUtil)
- 예외 처리 및 공통 응답 구조
- JPA Auditing을 통한 생성일/수정일 자동 관리

---

## 미구현/보완이 필요한 로직 체크리스트

- [ ] **주문 체결 스케줄러**
  - PENDING 상태의 주문을 주기적으로 조회하여, 주문가와 현재가를 비교해 체결 조건이 맞을 때 Execution 생성 및 Order 상태 변경
- [ ] **시장가 주문(Market Order) 지원**
  - OrderType에 MARKET 추가, 시장가 주문 처리 로직 구현
- [ ] **부분 체결/여러 번 체결 지원**
  - 한 주문이 여러 번에 나눠 체결되는 경우 처리
- [ ] **실제 증권사 API 연동**
  - 실제 주문/체결을 증권사 API와 연동(실제 서비스 확장 시)
- [ ] **회원가입/로그인/인증**
  - JWT 등 인증 로직, 회원가입/로그인 API 구현
- [ ] **테스트 코드 작성**
  - 서비스/컨트롤러 단위 테스트
- [x] **Swagger/OpenAPI 문서화**
  - API 명세 자동화
- [ ] **트랜잭션/동시성 처리 보완**
  - 주문/체결 등 동시성 이슈 보완
- [ ] **에러 메시지/코드 고도화**
  - 사용자 친화적 에러 메시지, 코드 정비
- [ ] **(선택) 주문/체결 내역 알림 기능**
  - 체결 시 사용자에게 알림 전송

---

## 참고

- 본 서비스는 실제 투자 서비스가 아니며, 교육/연습/시뮬레이션 용도로만 사용됩니다.
- 실시간 시세 데이터는 한국투자증권 OpenAPI를 통해 수집합니다.
